# OOTD 项目待办事项清单

> 基于需求文档与当前代码实现对比生成
> 生成时间: 2026-02-02

---

## 📋 功能完成度概览

| 模块 | 完成度 | 说明 |
|------|--------|------|
| 发布编辑器 | 40% | 标签编辑已完成，选品库和草稿功能待完善 |
| Feed流 | 50% | 布局完成，交互功能缺失 |
| 商品详情 | 60% | 展示完成，选品库和分享待实现 |
| 钱包 | 50% | UI完成，提现功能待实现 |
| 用户个人页 | 待检查 | 需要查看实现情况 |
| 发现页面 | 待检查 | 需要查看实现情况 |
| 消息模块 | 待检查 | 需要查看实现情况 |
| 原生功能 | 10% | 大部分未集成 |
| 性能优化 | 0% | 未开始 |
| 测试 | 0% | 无测试文件 |

---

## 🎯 P0 优先级（核心功能）

### 1. API 集成
- [ ] 替换所有模拟数据为真实 API 调用
- [ ] 实现 Dio 拦截器（Token 刷新、错误处理）
- [ ] 配置 API 基础地址和环境管理
- [ ] 实现网络请求缓存策略

### 2. 发布编辑器模块
- [ ] **选品库搜索功能**
  - [ ] 集成淘宝/京东商品搜索 API
  - [ ] 实现搜索结果分页加载
  - [ ] 添加商品筛选功能（价格、佣金、销量）
  - [ ] 实现商品收藏到选品库

- [ ] **粘贴链接解析**
  - [ ] 集成淘宝/京东链接解析 API
  - [ ] 实现淘口令自动识别和解析
  - [ ] 添加链接解析失败降级处理

- [ ] **草稿自动保存**
  - [ ] 实现 Hive 草稿箱存储
  - [ ] 配置自动保存触发机制（操作后 5 秒）
  - [ ] 实现草稿恢复功能
  - [ ] 添加草稿列表管理页面
  - [ ] 实现草稿过期检查（图片文件、链接有效期）

- [ ] **图片压缩策略**
  - [ ] 实现 Feed 流预览图压缩（480×640）
  - [ ] 实现缩略图生成（150×200）
  - [ ] 添加图片 EXIF 信息读取和排序

### 3. Feed 流模块
- [ ] **商品标签角标**
  - [ ] PostCard 添加商品数量角标显示
  - [ ] 实现角标点击跳转帖子详情

- [ ] **交互功能**
  - [ ] 实现点赞功能（UI + API）
  - [ ] 实现评论功能（UI + API）
  - [ ] 实现分享功能（UI + API）
  - [ ] 添加点赞动画效果

### 4. 钱包模块
- [ ] **提现功能**
  - [ ] 实现提现金额输入和验证
  - [ ] 集成提现 API
  - [ ] 添加提现记录查询
  - [ ] 实现提现到账通知

- [ ] **数据集成**
  - [ ] 替换余额为真实 API 数据
  - [ ] 替换佣金趋势图为真实数据
  - [ ] 替换佣金明细为真实数据

---

## 🔵 P1 优先级（重要功能）

### 5. 商品详情模块
- [ ] **加入选品库**
  - [ ] 实现加入选品库功能
  - [ ] 添加选品库管理页面
  - [ ] 实现选品库商品分类和搜索

- [ ] **分享功能**
  - [ ] 实现商品分享到微信/微博
  - [ ] 实现淘口令生成和复制
  - [ ] 添加分享统计埋点

### 6. 用户个人页模块
- [ ] 检查当前实现情况
- [ ] 实现个人信息展示和编辑
- [ ] 实现粉丝/关注列表
- [ ] 实现帖子/喜欢/收藏列表
- [ ] 添加个人主页背景图设置

### 7. 发现页面模块
- [ ] 检查当前实现情况
- [ ] 实现推荐内容展示
- [ ] 实现话题/标签浏览
- [ ] 实现热门穿搭推荐

### 8. 消息模块
- [ ] 检查当前实现情况
- [ ] 实现消息列表展示
- [ ] 实现私信聊天功能
- [ ] 实现系统通知推送
- [ ] 添加消息红点提示

### 9. 图片懒加载优化
- [ ] 实现图片预加载（前后各 2 行）
- [ ] 实现滚动时暂停加载
- [ ] 配置 ExtendedImage 内存缓存
- [ ] 添加图片加载占位图策略

### 10. Token 刷新机制
- [ ] 实现 Dio 拦截器自动刷新 Token
- [ ] 处理 401 错误重试逻辑
- [ ] 实现 Token 过期提示和跳转登录

---

## 🟢 P2 优先级（增强功能）

### 11. 原生功能集成

#### iOS
- [ ] **Universal Link 配置**
  - [ ] 配置 Associated Domains
  - [ ] 实现从淘宝分享链接跳转回 APP
  - [ ] 测试 Universal Link 唤起

- [ ] **Keychain 存储**
  - [ ] 集成 flutter_secure_storage
  - [ ] 使用 Keychain 存储 PID 等敏感信息

- [ ] **照片权限适配**
  - [ ] 适配 iOS 14+ 有限访问权限
  - [ ] 添加照片权限申请弹窗

- [ ] **App Tracking Transparency**
  - [ ] 添加 IDFA 权限申请弹窗
  - [ ] 配置隐私政策说明

#### Android
- [ ] **FileProvider 配置**
  - [ ] 配置 AndroidManifest.xml
  - [ ] 创建 file_paths.xml 资源文件
  - [ ] 实现分享图片到微信/微博

- [ ] **存储权限适配**
  - [ ] 适配 Android 10+ 分区存储
  - [ ] 实现运行时权限申请

- [ ] **后台下载**
  - [ ] 集成 flutter_downloader
  - [ ] 实现批量保存穿搭图片到相册

- [ ] **返回键处理**
  - [ ] 重写返回键逻辑
  - [ ] 底部弹窗打开时优先关闭弹窗

### 12. 扫码功能
- [ ] 集成 mobile_scanner
- [ ] 实现淘宝/京东商品二维码识别
- [ ] 实现扫码后跳转商品详情

### 13. 本地通知
- [ ] 集成 flutter_local_notifications
- [ ] 实现佣金到账提醒
- [ ] 实现审核通知
- [ ] 实现新消息提醒

### 14. 性能优化
- [ ] **启动速度优化**
  - [ ] 实现延迟初始化非关键 SDK
  - [ ] 生成原生启动屏（flutter_native_splash）
  - [ ] 实现首页数据预加载
  - [ ] 图片资源 WebP 格式转换
  - [ ] 字体文件子集化

- [ ] **内存管理**
  - [ ] 配置 ExtendedImage 内存缓存
  - [ ] 实现内存警告时清理缓存
  - [ ] 添加大图片内存占用限制

- [ ] **网络优化**
  - [ ] 实现 Feed 接口数据合并
  - [ ] 配置 CDN 域名分片
  - [ ] 启用响应体压缩

### 15. 埋点统计
- [ ] 集成 firebase_analytics 或自研埋点库
- [ ] 实现内容消费埋点（feed_impression、tag_click、product_detail_view、purchase_intent）
- [ ] 实现内容生产埋点（post_start_create、image_upload_success、tag_add、post_publish）
- [ ] 实现交易埋点（commission_settled）

### 16. 错误处理与监控
- [ ] **全局错误边界**
  - [ ] 实现 AppErrorWidget
  - [ ] 配置 FlutterError.onError
  - [ ] 实现 Zone 错误捕获

- [ ] **业务错误码处理**
  - [ ] 实现 401 自动刷新 Token
  - [ ] 实现 403 跳转登录
  - [ ] 实现 429 限流重试
  - [ ] 实现 500 显示重试按钮
  - [ ] 实现网络错误离线占位页

- [ ] **崩溃监控**
  - [ ] 集成 Sentry 或 Crashlytics
  - [ ] 配置崩溃上报

---

## 🧪 测试

### 17. 单元测试
- [ ] Domain 层业务逻辑测试（覆盖率 > 80%）
- [ ] 工具类测试
- [ ] 数据模型测试

### 18. Widget 测试
- [ ] 图片标签编辑器测试
- [ ] Feed 卡片测试
- [ ] 商品选择面板测试

### 19. 集成测试
- [ ] 发布流程测试
- [ ] 支付流程测试
- [ ] 登录流程测试

### 20. Golden 测试
- [ ] UI 回归测试
- [ ] 主题切换测试

---

## 📦 构建与部署

### 21. 环境管理
- [ ] 配置 Dev 环境
- [ ] 配置 Staging 环境
- [ ] 配置 Prod 环境
- [ ] 实现环境切换逻辑

### 22. 构建配置
- [ ] **Android**
  - [ ] 配置 ProGuard 混淆
  - [ ] 实现分离 ABI 构建
  - [ ] 配置签名

- [ ] **iOS**
  - [ ] 配置最低版本 iOS 12.0
  - [ ] 禁用 Bitcode
  - [ ] 配置签名

### 23. 代码规范
- [ ] 启用 flutter_lints 严格模式
- [ ] 配置代码格式化规则
- [ ] 添加 Git pre-commit hook

---

## 🔒 安全与合规

### 24. 数据安全
- [ ] 禁用明文 HTTP，仅允许 HTTPS
- [ ] 实现证书锁定（SSL Pinning）
- [ ] 启用 Dart 混淆（--obfuscate）
- [ ] Native 代码字符串加密

### 25. 隐私合规
- [ ] **Android**
  - [ ] targetSdkVersion 升级到 33+
  - [ ] 实现隐私政策弹窗
  - [ ] 仅在需要时申请权限

- [ ] **iOS**
  - [ ] 配置 App Tracking Transparency
  - [ ] 在 App Store Connect 填写 Privacy Nutrition Labels

---

## 📝 待检查模块

### 26. 用户个人页
- [ ] 检查 user_profile_page.dart 实现情况
- [ ] 检查相关 BLoC 和数据层实现

### 27. 发现页面
- [ ] 检查 discover_page.dart 实现情况
- [ ] 检查相关 BLoC 和数据层实现

### 28. 消息模块
- [ ] 检查 message_page.dart 实现情况
- [ ] 检查相关 BLoC 和数据层实现

---

## 📌 注意事项

1. **所有 API 集成需要后端配合完成**
2. **原生功能需要分别在 iOS 和 Android 平台测试**
3. **性能优化需要在真实设备上测试**
4. **测试覆盖率需要达到 80% 以上**
5. **所有第三方 SDK 密钥需要配置到环境变量**

---

## 📊 进度跟踪

- 总任务数: 100+
- 已完成: 20+
- 进行中: 0
- 待开始: 80+

---

*最后更新: 2026-02-02*